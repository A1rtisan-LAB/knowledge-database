# ğŸ”§ Knowledge Database ê´€ë¦¬ì ê°€ì´ë“œ

## ëª©ì°¨
1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì‚¬ìš©ì ê´€ë¦¬](#ì‚¬ìš©ì-ê´€ë¦¬)
3. [ì½˜í…ì¸  ê´€ë¦¬](#ì½˜í…ì¸ -ê´€ë¦¬)
4. [ì‹œìŠ¤í…œ êµ¬ì„±](#ì‹œìŠ¤í…œ-êµ¬ì„±)
5. [ëª¨ë‹ˆí„°ë§ ë° ë¶„ì„](#ëª¨ë‹ˆí„°ë§-ë°-ë¶„ì„)
6. [ë°±ì—… ë° ë³µêµ¬](#ë°±ì—…-ë°-ë³µêµ¬)
7. [ì„±ëŠ¥ íŠœë‹](#ì„±ëŠ¥-íŠœë‹)
8. [ë³´ì•ˆ ê´€ë¦¬](#ë³´ì•ˆ-ê´€ë¦¬)
9. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

## ì‹œìŠ¤í…œ ê°œìš”

### ì•„í‚¤í…ì²˜ êµ¬ì„± ìš”ì†Œ
- **ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„**: Gunicornì—ì„œ ì‹¤í–‰ë˜ëŠ” FastAPI
- **ë°ì´í„°ë² ì´ìŠ¤**: pgvector í™•ì¥ì´ ìˆëŠ” PostgreSQL
- **ê²€ìƒ‰ ì—”ì§„**: ì „ì²´ í…ìŠ¤íŠ¸ ë° ë²¡í„° ê²€ìƒ‰ì„ ìœ„í•œ OpenSearch
- **ìºì‹œ ë ˆì´ì–´**: ì„¸ì…˜ ë° ë°ì´í„° ìºì‹±ì„ ìœ„í•œ Redis
- **ë¡œë“œ ë°¸ëŸ°ì„œ**: Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
- **ì»¨í…Œì´ë„ˆ í”Œë«í¼**: Docker Composeê°€ ìˆëŠ” Docker

### ì•¡ì„¸ìŠ¤ ìˆ˜ì¤€
1. **Super Admin**: ì „ì²´ ì‹œìŠ¤í…œ ì•¡ì„¸ìŠ¤
2. **Admin**: ì‚¬ìš©ì ë° ì½˜í…ì¸  ê´€ë¦¬
3. **Moderator**: ì½˜í…ì¸  ê²€í†  ë° ìŠ¹ì¸
4. **Editor**: ì½˜í…ì¸  ìƒì„± ë° í¸ì§‘
5. **Viewer**: ì½ê¸° ì „ìš© ì•¡ì„¸ìŠ¤

## ì‚¬ìš©ì ê´€ë¦¬

### ì‚¬ìš©ì ìƒì„±
```bash
# Admin APIë¥¼ í†µí•´
POST /api/v1/admin/users
{
  "email": "user@example.com",
  "username": "johndoe",
  "role": "editor",
  "department": "Engineering"
}
```

### ëŒ€ëŸ‰ ì‚¬ìš©ì ê°€ì ¸ì˜¤ê¸°
1. ì‚¬ìš©ì ë°ì´í„°ê°€ ìˆëŠ” CSV íŒŒì¼ ì¤€ë¹„
2. ê´€ë¦¬ì íŒ¨ë„ â†’ ì‚¬ìš©ì â†’ ê°€ì ¸ì˜¤ê¸°ë¡œ ì´ë™
3. CSV íŒŒì¼ ì—…ë¡œë“œ
4. ê²€í†  ë° ê°€ì ¸ì˜¤ê¸° í™•ì¸
5. ì‚¬ìš©ìëŠ” í™œì„±í™” ì´ë©”ì¼ì„ ë°›ìŒ

### ê¶Œí•œ ê´€ë¦¬
- **ì—­í•  í• ë‹¹**: ê´€ë¦¬ì íŒ¨ë„ â†’ ì‚¬ìš©ì â†’ í¸ì§‘ â†’ ì—­í• 
- **ë¶€ì„œ ì•¡ì„¸ìŠ¤**: ë¶€ì„œ ê¸°ë°˜ ê¶Œí•œ êµ¬ì„±
- **API ì•¡ì„¸ìŠ¤**: API í† í° ìƒì„± ë° ê´€ë¦¬
- **ì†ë„ ì œí•œ**: ì‚¬ìš©ìë³„ ë˜ëŠ” ì—­í• ë³„ ì œí•œ ì„¤ì •

### ì‚¬ìš©ì í™œë™ ëª¨ë‹ˆí„°ë§
- ë¡œê·¸ì¸ íˆìŠ¤í† ë¦¬ ë³´ê¸°
- ì½˜í…ì¸  ê¸°ì—¬ ì¶”ì 
- API ì‚¬ìš© ëª¨ë‹ˆí„°ë§
- í™œë™ ë³´ê³ ì„œ ë‚´ë³´ë‚´ê¸°

## ì½˜í…ì¸  ê´€ë¦¬

### ì½˜í…ì¸  ì¡°ì •
1. **ê²€í†  ëŒ€ê¸°ì—´**: ê´€ë¦¬ì íŒ¨ë„ â†’ ì¡°ì •
2. **ì‚¬ìš© ê°€ëŠ¥í•œ ì‘ì—…**:
   - ê²Œì‹œ ìŠ¹ì¸
   - ë³€ê²½ ìš”ì²­
   - ì´ìœ ì™€ í•¨ê»˜ ê±°ë¶€
   - ì—ìŠ¤ì»¬ë ˆì´ì…˜ì„ ìœ„í•œ í”Œë˜ê·¸

### ì¹´í…Œê³ ë¦¬ ê´€ë¦¬
```python
# ì¹´í…Œê³ ë¦¬ êµ¬ì¡°
- ê¸°ìˆ 
  â”œâ”€â”€ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ
  â”‚   â”œâ”€â”€ ë°±ì—”ë“œ
  â”‚   â”œâ”€â”€ í”„ë¡ íŠ¸ì—”ë“œ
  â”‚   â””â”€â”€ DevOps
  â””â”€â”€ ë°ì´í„° ì‚¬ì´ì–¸ìŠ¤
      â”œâ”€â”€ ë¨¸ì‹  ëŸ¬ë‹
      â””â”€â”€ ë¶„ì„
```

### ëŒ€ëŸ‰ ì‘ì—…
- **ì½˜í…ì¸  ê°€ì ¸ì˜¤ê¸°**: JSON, CSV, ë§ˆí¬ë‹¤ìš´ ì§€ì›
- **ë°ì´í„° ë‚´ë³´ë‚´ê¸°**: ì „ì²´ ë˜ëŠ” í•„í„°ë§ëœ ë‚´ë³´ë‚´ê¸°
- **ëŒ€ëŸ‰ ì—…ë°ì´íŠ¸**: ë°°ì¹˜ ì¹´í…Œê³ ë¦¬ ë³€ê²½, íƒœê·¸ ì—…ë°ì´íŠ¸
- **ì •ë¦¬ ì‘ì—…**: ì¤‘ë³µ ì œê±°, ê¹¨ì§„ ë§í¬ ìˆ˜ì •

### ì½˜í…ì¸  í’ˆì§ˆ ê´€ë¦¬
- ìµœì†Œ ì½˜í…ì¸  ê¸¸ì´ ì„¤ì •
- í•„ìˆ˜ ë©”íƒ€ë°ì´í„° í•„ë“œ êµ¬ì„±
- í‘œì ˆ ê°ì§€ í™œì„±í™”
- ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš° êµ¬í˜„

## ì‹œìŠ¤í…œ êµ¬ì„±

### í™˜ê²½ ë³€ìˆ˜
```bash
# í•µì‹¬ ì„¤ì •
APP_ENV=production
SECRET_KEY=your-secret-key
DATABASE_URL=postgresql://user:pass@localhost/kb
REDIS_URL=redis://localhost:6379
OPENSEARCH_URL=http://localhost:9200

# ì„±ëŠ¥
MAX_CONNECTIONS=100
WORKER_COUNT=4
REQUEST_TIMEOUT=30

# ë³´ì•ˆ
JWT_EXPIRY=3600
RATE_LIMIT=100
CORS_ORIGINS=https://your-domain.com
```

### ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì„±
```sql
-- PostgreSQL ìµœì í™”
ALTER SYSTEM SET shared_buffers = '2GB';
ALTER SYSTEM SET effective_cache_size = '6GB';
ALTER SYSTEM SET maintenance_work_mem = '512MB';
ALTER SYSTEM SET random_page_cost = 1.1;
```

### ê²€ìƒ‰ ì—”ì§„ íŠœë‹
```json
// OpenSearch ì„¤ì •
{
  "index": {
    "number_of_shards": 3,
    "number_of_replicas": 1,
    "refresh_interval": "30s"
  },
  "analysis": {
    "analyzer": {
      "korean_analyzer": {
        "type": "custom",
        "tokenizer": "nori_tokenizer"
      }
    }
  }
}
```

## ëª¨ë‹ˆí„°ë§ ë° ë¶„ì„

### ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
- **ëŒ€ì‹œë³´ë“œ URL**: http://localhost:3000/grafana
- **ì£¼ìš” ë©”íŠ¸ë¦­**:
  - ìš”ì²­ ì†ë„ ë° ì§€ì—° ì‹œê°„
  - ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì„±ëŠ¥
  - ìºì‹œ ì ì¤‘ë¥ 
  - ê²€ìƒ‰ ì‘ë‹µ ì‹œê°„
  - ì˜¤ë¥˜ìœ¨

### ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸
```bash
# ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ë³´ê¸°
docker logs kb-app-prod -f

# íŠ¹ì • ì˜¤ë¥˜ ê²€ìƒ‰
docker logs kb-app-prod 2>&1 | grep ERROR

# ë¡œê·¸ ë‚´ë³´ë‚´ê¸°
docker logs kb-app-prod > app_logs_$(date +%Y%m%d).log
```

### ì‚¬ìš© ë¶„ì„
- ê°€ì¥ ë§ì´ ê²€ìƒ‰ëœ ìš©ì–´
- ì¸ê¸° ì½˜í…ì¸ 
- ì‚¬ìš©ì ì°¸ì—¬ ë©”íŠ¸ë¦­
- ì½˜í…ì¸  ìƒì„± ì¶”ì„¸
- API ì‚¬ìš© íŒ¨í„´

### ì•Œë¦¼ êµ¬ì„±
```yaml
# ì•Œë¦¼ ê·œì¹™ (Prometheus)
groups:
  - name: knowledge_db
    rules:
      - alert: HighErrorRate
        expr: rate(errors_total[5m]) > 0.05
      - alert: DatabaseDown
        expr: up{job="postgresql"} == 0
      - alert: LowDiskSpace
        expr: disk_free_percent < 10
```

## ë°±ì—… ë° ë³µêµ¬

### ìë™ ë°±ì—…
```bash
# ì¼ì¼ ë°±ì—… ìŠ¤í¬ë¦½íŠ¸
#!/bin/bash
BACKUP_DIR="/backups/$(date +%Y%m%d)"
mkdir -p $BACKUP_DIR

# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
pg_dump -h localhost -U kb_user knowledge_db > $BACKUP_DIR/database.sql

# OpenSearch ìŠ¤ëƒ…ìƒ·
curl -X PUT "localhost:9200/_snapshot/backup/$(date +%Y%m%d)?wait_for_completion=true"

# Redis ë°±ì—…
redis-cli BGSAVE
cp /var/lib/redis/dump.rdb $BACKUP_DIR/

# ì••ì¶• ë° ì•”í˜¸í™”
tar -czf $BACKUP_DIR.tar.gz $BACKUP_DIR
gpg --encrypt --recipient admin@example.com $BACKUP_DIR.tar.gz
```

### ë³µêµ¬ ì ˆì°¨
1. **ë°ì´í„°ë² ì´ìŠ¤ ë³µêµ¬**:
   ```bash
   psql -h localhost -U kb_user knowledge_db < backup.sql
   ```

2. **ê²€ìƒ‰ ì¸ë±ìŠ¤ ë³µêµ¬**:
   ```bash
   curl -X POST "localhost:9200/_snapshot/backup/20250821/_restore"
   ```

3. **ì „ì²´ ì‹œìŠ¤í…œ ë³µêµ¬**:
   - ëª¨ë“  ì„œë¹„ìŠ¤ ì¤‘ì§€
   - ë°ì´í„°ë² ì´ìŠ¤ ë³µì›
   - ê²€ìƒ‰ ì¸ë±ìŠ¤ ë³µì›
   - Redis ë°ì´í„° ë³µì›
   - ì„œë¹„ìŠ¤ ì¬ì‹œì‘
   - ê¸°ëŠ¥ í™•ì¸

## ì„±ëŠ¥ íŠœë‹

### ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
- **ì¸ë±ì‹± ì „ëµ**:
  ```sql
  CREATE INDEX idx_items_created ON knowledge_items(created_at);
  CREATE INDEX idx_items_category ON knowledge_items(category_id);
  CREATE INDEX idx_search_vector ON knowledge_items USING ivfflat (embedding);
  ```

- **ì¿¼ë¦¬ ìµœì í™”**:
  - ëŠë¦° ì¿¼ë¦¬ì— EXPLAIN ANALYZE ì‚¬ìš©
  - ì¿¼ë¦¬ ê²°ê³¼ ìºì‹± êµ¬í˜„
  - JOIN ì‘ì—… ìµœì í™”
  - ì •ê¸°ì ì¸ VACUUM ë° ANALYZE

### ìºì‹± ì „ëµ
```python
# Redis ìºì‹± êµ¬ì„±
CACHE_TTL = {
    'search_results': 300,  # 5ë¶„
    'user_sessions': 3600,  # 1ì‹œê°„
    'static_content': 86400, # 24ì‹œê°„
    'api_responses': 60     # 1ë¶„
}
```

### ë¦¬ì†ŒìŠ¤ ìŠ¤ì¼€ì¼ë§
- **ìˆ˜í‰ ìŠ¤ì¼€ì¼ë§**: ë” ë§ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…Œì´ë„ˆ ì¶”ê°€
- **ìˆ˜ì§ ìŠ¤ì¼€ì¼ë§**: ë©”ëª¨ë¦¬/CPU í• ë‹¹ ì¦ê°€
- **ë¡œë“œ ë°¸ëŸ°ì‹±**: Nginx ì—…ìŠ¤íŠ¸ë¦¼ ì„œë²„ êµ¬ì„±
- **CDN í†µí•©**: ì •ì  ìì‚° ì˜¤í”„ë¡œë“œ

## ë³´ì•ˆ ê´€ë¦¬

### ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ì‹œí–‰
- [ ] 2ë‹¨ê³„ ì¸ì¦ í™œì„±í™”
- [ ] SSL/TLS ì¸ì¦ì„œ ìœ íš¨
- [ ] ì •ê¸°ì ì¸ ë³´ì•ˆ ì—…ë°ì´íŠ¸ ì ìš©
- [ ] ë°©í™”ë²½ ê·œì¹™ êµ¬ì„±
- [ ] ì†ë„ ì œí•œ í™œì„±
- [ ] ì…ë ¥ ìœ íš¨ì„± ê²€ì‚¬ í™œì„±í™”
- [ ] SQL ì¸ì ì…˜ ë°©ì§€
- [ ] XSS ë³´í˜¸ êµ¬ì„±
- [ ] CORS ì ì ˆíˆ ì„¤ì •

### ì•¡ì„¸ìŠ¤ ì œì–´
```python
# ì—­í•  ê¸°ë°˜ ê¶Œí•œ
PERMISSIONS = {
    'super_admin': ['*'],
    'admin': ['user:*', 'content:*', 'analytics:view'],
    'moderator': ['content:review', 'content:approve'],
    'editor': ['content:create', 'content:edit', 'content:delete'],
    'viewer': ['content:view', 'search:*']
}
```

### ê°ì‚¬ ë¡œê¹…
- ëª¨ë“  ê´€ë¦¬ì ì‘ì—… ê¸°ë¡
- ì‚¬ìš©ì ì¸ì¦ ì´ë²¤íŠ¸
- ì½˜í…ì¸  ìˆ˜ì • ì¶”ì 
- API ì•¡ì„¸ìŠ¤ ê¸°ë¡
- ë³´ì•ˆ ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§

## ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œ

#### ë†’ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
```bash
# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
docker stats

# íŠ¹ì • ì„œë¹„ìŠ¤ ì¬ì‹œì‘
docker-compose restart opensearch

# ìºì‹œ ì •ë¦¬
redis-cli FLUSHDB
```

#### ëŠë¦° ê²€ìƒ‰ ì„±ëŠ¥
1. OpenSearch í´ëŸ¬ìŠ¤í„° ìƒíƒœ í™•ì¸
2. ì¸ë±ìŠ¤ ì„¤ì • ìµœì í™”
3. ì¿¼ë¦¬ ë³µì¡ì„± ê²€í† 
4. í•„ìš”ì‹œ í™ í¬ê¸° ì¦ê°€

#### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ì œ
```bash
# ì—°ê²° í…ŒìŠ¤íŠ¸
psql -h localhost -U kb_user -d knowledge_db -c "SELECT 1"

# ì—°ê²° í’€ í™•ì¸
SELECT count(*) FROM pg_stat_activity;

# ìœ íœ´ ì—°ê²° ì¢…ë£Œ
SELECT pg_terminate_backend(pid) 
FROM pg_stat_activity 
WHERE state = 'idle' AND state_change < now() - interval '1 hour';
```

### ë¹„ìƒ ì ˆì°¨

#### ì‹œìŠ¤í…œ ë³µêµ¬
1. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
2. ì˜¤ë¥˜ ë¡œê·¸ ê²€í† 
3. ì‹¤íŒ¨í•œ ì„œë¹„ìŠ¤ ì¬ì‹œì‘
4. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
5. ê²€ìƒ‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
6. ì‚¬ìš©ì ì•¡ì„¸ìŠ¤ í™•ì¸

#### ë°ì´í„° ì†ìƒ
1. ì˜í–¥ë°›ì€ ì„œë¹„ìŠ¤ ì¤‘ì§€
2. ìµœì‹  ë°±ì—…ì—ì„œ ë³µì›
3. ë°ì´í„° ë¬´ê²°ì„± í™•ì¸
4. í•„ìš”ì‹œ ê²€ìƒ‰ ë°ì´í„° ì¬ìƒ‰ì¸
5. ì†ìƒëœ ìºì‹œ ì •ë¦¬

### ì§€ì› ì—ìŠ¤ì»¬ë ˆì´ì…˜
1. **ë ˆë²¨ 1**: ì‹œìŠ¤í…œ ì•Œë¦¼ ë° ëª¨ë‹ˆí„°ë§
2. **ë ˆë²¨ 2**: ê´€ë¦¬íŒ€ ì¡°ì‚¬
3. **ë ˆë²¨ 3**: ê°œë°œíŒ€ ì°¸ì—¬
4. **ê¸´ê¸‰**: ë¹„ìƒ ëŒ€ì‘íŒ€

---

**ë²„ì „**: 1.0.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-08-21  
**ë¹„ìƒ ì—°ë½ì²˜**: ops@your-domain.com  
**ë¬¸ì„œ**: https://docs.your-domain.com